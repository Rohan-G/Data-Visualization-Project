<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/popper.js@1"></script>
    <script src="https://unpkg.com/tippy.js@5"></script>
    <title>Project</title>
</head>
<body>
    <div>
        <input type="radio" name="myradio" value="0" labelfor="0" id="0" checked='checked'/>
        <label for="0">Top 10 drivers based on overall points</label><br/>
        <input type="radio" name="myradio" value="1" labelfor="1" id="1"/>
        <label for="1">Top 10 drivers based on overall race wins</label><br/>
        <input type="radio" name="myradio" value="2" labelfor="2" id="2"/>
        <label for="2">Top 10 drivers based on overall Championships</label><br/>
        <svg width="1425" height="780" class="radial-chart" style="background-color:#EFE0BB">
        </svg>
    </div>
    
    <script>
        var data = []
        let svg = d3.select(".radial-chart")
        // svg.append("input")
        // .attr("type", "radio")
        // .attr("name", "myradio")
        // .attr("value", 0)
        // .attr("labelfor", 0)
        // .attr("id", 0)
        // // .attr("checked", checked)
        // svg.append("label")
        // .attr("for", 0)
        // .text("Top 10 drivers based on overall points")
        // svg.append("input")
        // .attr("type", "radio")
        // .attr("name", "myradio")
        // .attr("value", 1)
        // .attr("labelfor", 1)
        // .attr("id", 1)
        // svg.append("label")
        // .attr("for", 1)
        // .text("Top 10 drivers based on overall race wins")
        // svg.append("input")
        // .attr("type", "radio")
        // .attr("name", "myradio")
        // .attr("value", 2)
        // .attr("labelfor", 2)
        // .attr("id", 2)
        // svg.append("label")
        // .attr("for", 2)
        // .text("Top 10 drivers based on overall championships")
        const func = async function (data, ind, mult)
        {
            data = await d3.csv("https://raw.githubusercontent.com/Rohan-G/Data-Visualization-Project/main/dataset/f1db_csv/allseasonstandings.csv")
            console.log(data)

            center = [700, 350]

            var arc = d3.arc()
            .innerRadius(120)
            .outerRadius(122)
            .startAngle(- Math.PI * 1/2)
            .endAngle(Math.PI);
            svg.append("path")
            .attr('transform', "translate("+center[0]+", "+center[1] + ")")
            .attr("class", "arc")
            .attr("d", arc)
            .attr("fill","black");

            for(var i=1950; i<2023; i+=10)
            {
                if (i > 1970)
                {
                    angle = (i - 1998.66)/(2023 - 1998.66) * 180 * 1/2
                    svg.append("text")
                    .attr("x", center[0] + 75)
                    .attr("y", center[1] + 5)
                    .attr("transform", "rotate("+angle+", " + center[0] +", "+center[1] + ")")
                    .text(i.toString())
                }
                else
                {
                    angle = (i - 1950)/(2023 - 1950) * 180 * 3/2
                    svg.append("text")
                    .attr("x", center[0] - 110)
                    .attr("y", center[1] + 5)
                    .attr("transform", "rotate("+angle+", " + center[0] +", "+center[1] + ")")
                    .text(i.toString())
                }
                angle = (i - 1950)/(2023 - 1950) * 180 * 3/2
                svg.append("line")
                .attr("x1", center[0] - 120)
                .attr("x2", center[0] - 110)
                .attr("y1", center[1])
                .attr("y2", center[1])
                .attr("transform", "rotate("+angle+", " + center[0] +", "+center[1] + ")")
                .attr("style", "stroke: black; stroke-width: 2")
            }

            const headers = ['Overall Points in career']
            const top = [['Lewis Hamilton', 'Sebastian Vettel', 'Fernando Alonso', 'Max Verstappen', 'Kimi Raikkonen', 'Valtteri Bottas', 'Nico Rosberg', 'Michael Schumacher', 'Daniel Ricciardo', 'Jenson Button'], ['Lewis Hamilton', 'Michael Schumacher', 'Sebastian Vettel', 'Alain Prost', 'Ayrton Senna', 'Max Verstappen', 'Fernando Alonso', 'Nigel Mansell', 'Jackie Stewart', 'Jim Clark'], ['Michael Schumacher', 'Lewis Hamilton', 'Juan Fangio', 'Alain Prost', 'Sebastian Vettel', 'Jack Brabham', 'Jackie Stewart', 'Niki Lauda', 'Nelson Piquet', 'Ayrton Senna']]
            const carcolours = new Map()
            carcolours.set('Ferrari', '#EF1A2D')
            carcolours.set('Mercedes', '#0D98BA')
            carcolours.set('Red Bull', ' #00008B')
            carcolours.set('Toro Rosso/Red Bull', ' #00008B')
            carcolours.set('Toro Rosso', '#1D19AC')
            carcolours.set('BMW Sauber/Toro Rosso', '#1D19AC')
            carcolours.set('McLaren', '#FF8000')
            carcolours.set('Aston Martin', '#037A68')
            carcolours.set('Benetton', '#037A68')
            carcolours.set('Jordan/Benetton', '#037A68')
            carcolours.set('Williams', '#FFFFFF')
            carcolours.set('Renault', '#FFF500')
            carcolours.set('Honda', '#CC0000')
            carcolours.set('BAR', '#6e7a77')
            carcolours.set('Alfa Romeo', '#A42134')
            carcolours.set('Sauber', '#739CD9')
            carcolours.set('Alpine F1 Team', '#2173B8')
            carcolours.set('Lotus F1', '#86995B')
            carcolours.set('Team Lotus', '#86995B')
            carcolours.set('Lotus-Climax', '#86995B')
            carcolours.set('Lotus-BRM', '#86995B')
            carcolours.set('Lotus-Climax/Lotus-BRM', '#86995B')
            carcolours.set('BRM', '#86995B')
            // var ind = 0
            // var mult = 1
            var drivcolors = ["", "", "", "", "", "", "", "", "", ""]
            var drivpoints = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            var drivwins = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            var drivchamps = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
            for(let i=0; i<data.length; i++)
            {
                // console.log(data[i]["Driver"])
                if (top[ind].includes(data[i]["Driver"]))
                {
                    const index = top[ind].indexOf(data[i]["Driver"])
                    var colour;
                    var carcolour = carcolours.get(data[i]['Constructor']);
                    if (carcolour == null)
                    {
                        carcolour = 'black'
                    }
                    drivcolors[index] = carcolour
                    drivpoints[index] += parseInt(data[i]["Points"])
                    drivwins[index] += parseInt(data[i]["Wins"])

                    if (data[i]['Pos'] == 1)
                    {
                        colour = "gold"
                        drivchamps[index] += 1
                    }
                    else if (data[i]['Pos'] == 2)
                    {
                        colour = "silver"
                    } 
                    else if (data[i]['Pos'] == 3)
                    {
                        colour = "#CD7F32"
                    }
                    else
                    {
                        colour = carcolour
                    }
                    const ccolor = carcolour
                    angle = (data[i]["Year"] - 1950)/(2023 - 1950) * 180 * 3/2
                    const yr = data[i]["Year"]
                    const curdata = data[i]
                    svg.append("circle")
                    .attr("cx", center[0]-128 - index * 20)
                    .attr("cy", center[1])
                    .attr("r", 4)
                    .attr("transform", "rotate("+angle+", " + center[0] +", "+center[1] + ")")
                    .attr('stroke', "black")
                    .attr('fill', colour)
                    .attr("id", function(){return "c"+index+data[i]["Year"]})
                    .on("mouseover", function() {
                        d3.select("#c"+index+yr).attr('stroke', ccolor)
                        tippy("#c"+index+yr, {
                        content: "Driver: "+curdata["Driver"]+"<br>Position: "+curdata["Pos"]+"<br>Team: "+curdata["Constructor"]+"<br>Points: "+curdata["Points"]+"<br>Wins: "+curdata["Wins"]+"<br>Year: "+curdata["Year"]
                        })
                    })
                    .on("mouseout", function() {
                        d3.select("#c"+index+yr).attr('stroke', "black")
                    })
                }
            }
            for(var i=0; i<10; i++)
            {
                const ind2 = i
                let points2 = 0
                if (ind == 0)
                {
                    const points = drivpoints[ind2]
                    points2 = points
                }
                else if (ind == 1)
                {
                    const points = drivwins[ind2]
                    points2 = points
                }
                else if (ind == 2)
                {
                    const points = drivchamps[ind2]
                    points2 = points
                }
                const colour = drivcolors[ind2]
                
                svg.append("rect")
                .attr("x", center[0] - 147 - points2/10 * mult)
                .attr("y", center[1] + 120 + i * 20)
                .attr("width", points2/10 * mult)
                .attr("height", 15)
                .attr("style", "fill: "+drivcolors[i]+"; stroke-width: 2; stroke: black")
                .attr("id", "r"+i)
                .on("mouseover", function() {
                    d3.select("#r"+ind2).attr('stroke', colour)
                    if (ind == 0)
                    {
                        tippy("#r"+ind2, {
                        content: "Total Points: "+points2
                        })
                    }
                    else if (ind == 1)
                    {
                        tippy("#r"+ind2, {
                        content: "Total Wins: "+points2
                        })
                    }
                    else if (ind == 2)
                    {
                        tippy("#r"+ind2, {
                        content: "Total Championships: "+points2
                        })
                    }
                })
                .on("mouseout", function() {
                    d3.select("#r"+ind2).attr('stroke', "black")
                })

                svg.append("text")
                .attr("x", center[0] - 10)
                .attr("y", center[1] + 132 + i * 20)
                .text(top[ind][i])
                .attr("text-anchor", "end")
            }

            // // x axis
            // svg.append("line")
            // .attr("x1", "50")
            // .attr("x2", "480")
            // .attr("y1", "290")
            // .attr("y2", "290")
            // .attr("style", "stroke: black; stroke-width: 3")
            
            // // y axis
            // svg.append("line")
            // .attr("x1", "60")
            // .attr("x2", "60")
            // .attr("y1", "180")
            // .attr("y2", "300")
            // .attr("style", "stroke: black; stroke-width: 3")
            
            // svg.append("text")
            // .attr("x", "250")
            // .attr("y", "350")
            // .text("Name")

            // svg.append("text")
            // .attr("x", "250")
            // .attr("y", "100")
            // .text(year + " data")
            
            // svg.append("text")
            // .attr("x", "30")
            // .attr("y", "250")
            // .attr("transform", "rotate(270, 30, 250)")
            // .text("Value")
            
            // let x_initial = 70;
            // let yearx = "X" + year
            // for (let i = 0; i < data.length; i++) {
            //     let this_x = data[i]["Name"];
            //     let this_y = parseInt(data[i][yearx]);
            //     let this_data = this_y + 10
            //     let num = i * 40 + x_initial;
            //     svg.append("rect")
            //     .attr("x", num.toString())
            //     .attr("y", 290 - this_y.toString())
            //     .attr("width", "35")
            //     .attr("height", this_y.toString())
            //     .attr("id", function() {return "b"+i})
            //     .attr("style", "fill: rgb(255, 0, 0); stroke-width: 2; stroke: black")
                
            //     .on("mouseover", function () {
            //         d3.select("#b"+i).attr("style", "fill: rgb(0, 0, 255); stroke-width: 2; stroke: black")
            //         d3.select("#s"+i).attr("style", "fill: rgb(0, 0, 255); stroke-width: 2; stroke: black")
            //         tippy('#b'+i, {
            //         content: "Name: "+this_x+"<br>X: "+this_y
            //         });
            //     })
            //     .on("mouseout", function () {
            //         d3.select("#b"+i).attr("style", "fill: rgb(255, 0, 0); stroke-width: 2; stroke: black")
            //         d3.select("#s"+i).attr("style", "fill: rgb(255, 0, 0); stroke-width: 2; stroke: black")
            //     })

            //     svg.append("line")
            //     .attr("x1", num + 17.5)
            //     .attr("x2", num + 17.5)
            //     .attr("y1", 290)
            //     .attr("y2", 290 + 10)
            //     .attr("style", "stroke: black; stroke-width: 3")

            //     svg.append("text")
            //     .attr("x", num + 12.5)
            //     .attr("y", 290 + 30)
            //     .text(this_x)
            // }
            // for(let i = 0; i < 10; i++)
            // {
            //     svg.append("line")
            //     .attr("x1", 50)
            //     .attr("x2", 60)
            //     .attr("y1", 290 - i * 10)
            //     .attr("y2", 290 - i * 10)
            //     .attr("style", "stroke: black; stroke-width: 3")
            //     svg.append("text")
            //     .attr("x", 40)
            //     .attr("y", 290 - i * 10)
            //     .attr("style", "font-size: 0.5vw")
            //     .text(10 * i)
            // }

            // data = await d3.csv("https://raw.githubusercontent.com/sarthakchittawar/DataVisualization/main/yearwise.csv")
            
            // x axis
            // svg2.append("line")
            // .attr("x1", "220")
            // .attr("x2", "670")
            // .attr("y1", "580")
            // .attr("y2", "580")
            // .attr("style", "stroke: black; stroke-width: 3")
            
            // y axis
            // svg2.append("line")
            // .attr("x1", "240")
            // .attr("x2", "240")
            // .attr("y1", "360")
            // .attr("y2", "580")
            // .attr("style", "stroke: black; stroke-width: 3")
            
            // svg2.append("text")
            // .attr("x", "420")
            // .attr("y", "640")
            // .text("X")

            // svg2.append("text")
            // .attr("x", "420")
            // .attr("y", "340")
            // .text(year + " data")
            
            // svg2.append("text")
            // .attr("x", "80")
            // .attr("y", "600")
            // .attr("transform", "rotate(270, 60, 500)")
            // .text("Y")
            
            // yearx = "X" + year
            // let yeary = "Y" + year
            // let yearr = "R" + year
            // for (let i = 0; i < data.length; i++) {
            //     let this_x = parseInt(data[i][yearx]);
            //     let this_y = parseInt(data[i][yeary]);
            //     let radius = parseInt(data[i][yearr]);
            //     svg2.append("circle")
            //     .attr("cx", (60 + this_x)*4)
            //     .attr("cy", (290 - this_y)*2)
            //     .attr("r", radius)
            //     .attr("id", function() {return "s"+i})
            //     .attr("style", "fill: rgb(255, 0, 0); stroke-width: 2; stroke: black")
            //     .on("mouseover", function () {
            //         d3.select("#b"+i).attr("style", "fill: rgb(0, 0, 255); stroke-width: 2; stroke: black")
            //         d3.select("#s"+i).attr("style", "fill: rgb(0, 0, 255); stroke-width: 2; stroke: black")
            //         tippy('#s'+i, {
            //         content: "Center: ("+this_x+", "+this_y+")<br>Radius: "+radius
            //         });
            //     })
            //     .on("mouseout", function () {
            //         d3.select("#b"+i).attr("style", "fill: rgb(255, 0, 0); stroke-width: 2; stroke: black")
            //         d3.select("#s"+i).attr("style", "fill: rgb(255, 0, 0); stroke-width: 2; stroke: black")
            //     })
            // }
            // for(let i = 0; i < 11; i++)
            // {
            //     svg2.append("line")
            //     .attr("x1", 50*2 + 120)
            //     .attr("x2", 60*2 + 120)
            //     .attr("y1", (290 - i * 10)*2)
            //     .attr("y2", (290 - i * 10)*2)
            //     .attr("style", "stroke: black; stroke-width: 3")
            //     svg2.append("text")
            //     .attr("x", 40*2 + 120)
            //     .attr("y", (290 - i * 10)*2)
            //     .attr("style", "font-size: 0.5vw")
            //     .text((10 * i))

            //     svg2.append("line")
            //     .attr("x1", 60*2 + 120 + i*40)
            //     .attr("x2", 60*2 + 120 + i*40)
            //     .attr("y1", (290)*2)
            //     .attr("y2", (290)*2 + 10)
            //     .attr("style", "stroke: black; stroke-width: 3")
            //     svg2.append("text")
            //     .attr("x", 60*2 + 115 + i*40)
            //     .attr("y", (290)*2 + 30)
            //     .attr("style", "font-size: 1vw")
            //     .text((10 * i))
            // }
        }
        let b1 = document.getElementById("0")
        let b2 = document.getElementById("1")
        let b3 = document.getElementById("2")
        
        b1.addEventListener("click", function (){
            ind = 0
            mult = 1
            svg.selectAll("*").remove()
            func(data, ind, mult);
        })
        b2.addEventListener("click", function (){
            ind = 1
            mult = 50
            svg.selectAll("*").remove()
            func(data, ind, mult);
        })
        b3.addEventListener("click", function (){
            ind = 2
            mult = 500
            svg.selectAll("*").remove()
            func(data, ind, mult);
        })
        func(data, 0, 1);
    </script>
</body>
</html>